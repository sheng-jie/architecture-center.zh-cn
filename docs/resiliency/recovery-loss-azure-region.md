---
title: "从 Azure 区域的损失恢复"
description: "本文可帮助了解和设计有复原能力和高可用性的容错应用程序，以及对灾难恢复进行规划"
author: adamglick
ms.date: 08/18/2016
ms.openlocfilehash: 42a7d865e101b43279f3198f3dd75df1b15a8565
ms.sourcegitcommit: b0482d49aab0526be386837702e7724c61232c60
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 11/14/2017
---
[!INCLUDE [header](../_includes/header.md)]
# <a name="azure-resiliency-technical-guidance-recovery-from-a-region-wide-service-disruption"></a><span data-ttu-id="f32de-103">Azure 复原技术指南：在发生区域范围的服务中断后进行恢复</span><span class="sxs-lookup"><span data-stu-id="f32de-103">Azure resiliency technical guidance: recovery from a region-wide service disruption</span></span>
<span data-ttu-id="f32de-104">Azure 在物理上和逻辑上划分为称为区域的单位。</span><span class="sxs-lookup"><span data-stu-id="f32de-104">Azure is divided physically and logically into units called regions.</span></span> <span data-ttu-id="f32de-105">一个区域由一个或多个邻近的数据中心组成。</span><span class="sxs-lookup"><span data-stu-id="f32de-105">A region consists of one or more datacenters in close proximity.</span></span> 

<span data-ttu-id="f32de-106">在极少数情况下，整个区域的设施可能都无法访问，例如，由于出现网络故障。</span><span class="sxs-lookup"><span data-stu-id="f32de-106">Under rare circumstances, it is possible that facilities in an entire region can become inaccessible, for example due to network failures.</span></span> <span data-ttu-id="f32de-107">或自然灾害等原因造成的完全失去联系。</span><span class="sxs-lookup"><span data-stu-id="f32de-107">Or facilities can be lost entirely, for example due to a natural disaster.</span></span> <span data-ttu-id="f32de-108">本部分说明可用于创建在各区域间分布的应用程序的 Azure 功能。</span><span class="sxs-lookup"><span data-stu-id="f32de-108">This section explains the capabilities of Azure for creating applications that are distributed across regions.</span></span> <span data-ttu-id="f32de-109">这种分布有助于最大程度地减少一个区域的故障影响到其他区域的可能性。</span><span class="sxs-lookup"><span data-stu-id="f32de-109">Such distribution helps to minimize the possibility that a failure in one region could affect other regions.</span></span>

## <a name="cloud-services"></a><span data-ttu-id="f32de-110">云服务</span><span class="sxs-lookup"><span data-stu-id="f32de-110">Cloud services</span></span>
### <a name="resource-management"></a><span data-ttu-id="f32de-111">资源管理</span><span class="sxs-lookup"><span data-stu-id="f32de-111">Resource management</span></span>
<span data-ttu-id="f32de-112">要将计算实例分布在多个区域上，可在每个目标区域中创建单独的云服务，然后将部署包发布到每个云服务上。</span><span class="sxs-lookup"><span data-stu-id="f32de-112">You can distribute compute instances across regions by creating a separate cloud service in each target region, and then publishing the deployment package to each cloud service.</span></span> <span data-ttu-id="f32de-113">但请注意，必须由应用程序开发人员或使用流量管理服务在不同区域的云服务间分布流量。</span><span class="sxs-lookup"><span data-stu-id="f32de-113">However, note that distributing traffic across cloud services in different regions must be implemented by the application developer or with a traffic management service.</span></span>

<span data-ttu-id="f32de-114">在容量规则方面，事先确定为实现灾难恢复而部署的备用角色实例数目是其中的重要一环。</span><span class="sxs-lookup"><span data-stu-id="f32de-114">Determining the number of spare role instances to deploy in advance for disaster recovery is an important aspect of capacity planning.</span></span> <span data-ttu-id="f32de-115">具有规模完整的辅助部署可确保容量在需要时始终可用，但是，这实际上也会使成本加倍。</span><span class="sxs-lookup"><span data-stu-id="f32de-115">Having a full-scale secondary deployment ensures that capacity is already available when needed; however, this effectively doubles the cost.</span></span> <span data-ttu-id="f32de-116">常见的模式是准备小型的辅助部署，规模足以满足运行关键服务即可。</span><span class="sxs-lookup"><span data-stu-id="f32de-116">A common pattern is to have a small, secondary deployment, just large enough to run critical services.</span></span> <span data-ttu-id="f32de-117">建议建立一个小型辅助部署用于保留容量和测试辅助环境的配置。</span><span class="sxs-lookup"><span data-stu-id="f32de-117">This small secondary deployment is a good idea, both to reserve capacity, and for testing the configuration of the secondary environment.</span></span>

> [!NOTE]
> <span data-ttu-id="f32de-118">订阅配额并非容量保证。</span><span class="sxs-lookup"><span data-stu-id="f32de-118">The subscription quota is not a capacity guarantee.</span></span> <span data-ttu-id="f32de-119">配额只是信用限制。</span><span class="sxs-lookup"><span data-stu-id="f32de-119">The quota is simply a credit limit.</span></span> <span data-ttu-id="f32de-120">若要保证容量，必须在服务模型中定义所需数量的角色，且必须部署这些角色。</span><span class="sxs-lookup"><span data-stu-id="f32de-120">To guarantee capacity, the required number of roles must be defined in the service model, and the roles must be deployed.</span></span>
> 
> 

### <a name="load-balancing"></a><span data-ttu-id="f32de-121">负载均衡</span><span class="sxs-lookup"><span data-stu-id="f32de-121">Load Balancing</span></span>
<span data-ttu-id="f32de-122">若要实现各区域流量的负载均衡，需要使用流量管理解决方案。</span><span class="sxs-lookup"><span data-stu-id="f32de-122">To load balance traffic across regions requires a traffic management solution.</span></span> <span data-ttu-id="f32de-123">Azure 提供 [Azure 流量管理器](https://azure.microsoft.com/services/traffic-manager/)。</span><span class="sxs-lookup"><span data-stu-id="f32de-123">Azure provides [Azure Traffic Manager](https://azure.microsoft.com/services/traffic-manager/).</span></span> <span data-ttu-id="f32de-124">也可以利用提供类似流理管理功能的第三方服务。</span><span class="sxs-lookup"><span data-stu-id="f32de-124">You can also take advantage of third-party services that provide similar traffic management capabilities.</span></span>

### <a name="strategies"></a><span data-ttu-id="f32de-125">策略</span><span class="sxs-lookup"><span data-stu-id="f32de-125">Strategies</span></span>
<span data-ttu-id="f32de-126">可以使用多种备用策略在区域间实现分布式计算。</span><span class="sxs-lookup"><span data-stu-id="f32de-126">Many alternative strategies are available for implementing distributed compute across regions.</span></span> <span data-ttu-id="f32de-127">这些策略必须根据特定业务要求和应用程序的情况量身定制。</span><span class="sxs-lookup"><span data-stu-id="f32de-127">These must be tailored to the specific business requirements and circumstances of the application.</span></span> <span data-ttu-id="f32de-128">大体而言，方法可分为以下几类：</span><span class="sxs-lookup"><span data-stu-id="f32de-128">At a high level, the approaches can be divided into the following categories:</span></span>

* <span data-ttu-id="f32de-129">**发生灾难时重新部署**：如果采用这种方法，则会在灾难发生时从头开始重新部署应用程序。</span><span class="sxs-lookup"><span data-stu-id="f32de-129">**Redeploy on disaster**: In this approach the application is redeployed from scratch at the time of disaster.</span></span> <span data-ttu-id="f32de-130">这种方法适合不需要保证恢复时间的非关键应用程序。</span><span class="sxs-lookup"><span data-stu-id="f32de-130">This is appropriate for non-critical applications that don’t require a guaranteed recovery time.</span></span>
* <span data-ttu-id="f32de-131">**暖备份（主动/被动）**：在备用区域创建辅助托管服务，并部署角色以保证最低容量；但是，角色不会接收生产流量。</span><span class="sxs-lookup"><span data-stu-id="f32de-131">**Warm Spare (Active/Passive)**: A secondary hosted service is created in an alternate region, and roles are deployed to guarantee minimal capacity; however, the roles don’t receive production traffic.</span></span> <span data-ttu-id="f32de-132">对于未设计为在区域间分布流量的应用程序来说，这种方法很有用。</span><span class="sxs-lookup"><span data-stu-id="f32de-132">This approach is useful for applications that have not been designed to distribute traffic across regions.</span></span>
* <span data-ttu-id="f32de-133">**热备份（主动/主动）**：应用程序设计为接收多个区域的生产负载。</span><span class="sxs-lookup"><span data-stu-id="f32de-133">**Hot Spare (Active/Active)**: The application is designed to receive production load in multiple regions.</span></span> <span data-ttu-id="f32de-134">为每个区域中云服务所配置的容量可能高于灾难恢复用途所需的容量。</span><span class="sxs-lookup"><span data-stu-id="f32de-134">The cloud services in each region might be configured for higher capacity than required for disaster recovery purposes.</span></span> <span data-ttu-id="f32de-135">或者，云服务可在灾难或故障转移时进行扩展。</span><span class="sxs-lookup"><span data-stu-id="f32de-135">Alternatively, the cloud services might scale out as necessary at the time of a disaster and failover.</span></span> <span data-ttu-id="f32de-136">这种方法需要在应用程序设计中进行大量的投资，但是也具有明显的好处。</span><span class="sxs-lookup"><span data-stu-id="f32de-136">This approach requires substantial investment in application design, but it has significant benefits.</span></span> <span data-ttu-id="f32de-137">这些好处包括恢复时间更短且更有保证、连续测试所有恢复位置和对容量的有效使用。</span><span class="sxs-lookup"><span data-stu-id="f32de-137">These include low and guaranteed recovery time, continuous testing of all recovery locations, and efficient usage of capacity.</span></span>

<span data-ttu-id="f32de-138">关于分布式设计的完整讨论不属于本文档的范畴。</span><span class="sxs-lookup"><span data-stu-id="f32de-138">A complete discussion of distributed design is outside the scope of this document.</span></span> <span data-ttu-id="f32de-139">有关更多信息，请参阅 [Azure 应用程序的灾难恢复和高可用性](https://aka.ms/drtechguide)。</span><span class="sxs-lookup"><span data-stu-id="f32de-139">For further information, see [Disaster Recovery and High Availability for Azure Applications](https://aka.ms/drtechguide).</span></span>

## <a name="virtual-machines"></a><span data-ttu-id="f32de-140">虚拟机</span><span class="sxs-lookup"><span data-stu-id="f32de-140">Virtual Machines</span></span>
<span data-ttu-id="f32de-141">基础结构即服务 (IaaS) 虚拟机 (VM) 的恢复在许多方面与平台即服务 (PaaS) 计算恢复相似。</span><span class="sxs-lookup"><span data-stu-id="f32de-141">Recovery of infrastructure as a service (IaaS) virtual machines (VMs) is similar to platform as a service (PaaS) compute recovery in many respects.</span></span> <span data-ttu-id="f32de-142">但是，由于 IaaS VM 包含 VM 和 VM 磁盘，因此两者之间也存在一些重要的差异。</span><span class="sxs-lookup"><span data-stu-id="f32de-142">There are important differences, however, due to the fact that an IaaS VM consists of both the VM and the VM disk.</span></span>

* <span data-ttu-id="f32de-143">**使用 Azure 备份创建应用程序一致的跨区域备份**。</span><span class="sxs-lookup"><span data-stu-id="f32de-143">**Use Azure Backup to create cross region backups that are application consistent**.</span></span>
  <span data-ttu-id="f32de-144">[Azure 备份](https://azure.microsoft.com/services/backup/)可让客户跨多个 VM 磁盘创建应用程序一致的备份，并支持跨区域的备份复制。</span><span class="sxs-lookup"><span data-stu-id="f32de-144">[Azure Backup](https://azure.microsoft.com/services/backup/) enables customers to create application consistent backups across multiple VM disks, and support replication of backups across regions.</span></span> <span data-ttu-id="f32de-145">为此，可在创建时选择异地复制备份保管库。</span><span class="sxs-lookup"><span data-stu-id="f32de-145">You can do this by choosing to geo-replicate the backup vault at the time of creation.</span></span> <span data-ttu-id="f32de-146">请注意，必须在创建时配置备份保管库的复制，</span><span class="sxs-lookup"><span data-stu-id="f32de-146">Note that replication of the backup vault must be configured at the time of creation.</span></span> <span data-ttu-id="f32de-147">而不能在以后设置。</span><span class="sxs-lookup"><span data-stu-id="f32de-147">It can't be set later.</span></span> <span data-ttu-id="f32de-148">如果某个区域发生服务中断，Microsoft 将向客户提供备份。</span><span class="sxs-lookup"><span data-stu-id="f32de-148">If a region is lost, Microsoft will make the backups available to customers.</span></span> <span data-ttu-id="f32de-149">客户将可以还原到其配置的任何还原点。</span><span class="sxs-lookup"><span data-stu-id="f32de-149">Customers will be able to restore to any of their configured restore points.</span></span>
* <span data-ttu-id="f32de-150">**将数据磁盘与操作系统磁盘分开**。</span><span class="sxs-lookup"><span data-stu-id="f32de-150">**Separate the data disk from the operating system disk**.</span></span> <span data-ttu-id="f32de-151">有关 IaaS VM 的一项重要注意事项就是，如果不重新创建 VM 就不能更改操作系统磁盘。</span><span class="sxs-lookup"><span data-stu-id="f32de-151">An important consideration for IaaS VMs is that you cannot change the operating system disk without re-creating the VM.</span></span> <span data-ttu-id="f32de-152">如果恢复策略是在灾难后部署的，这便不是问题。</span><span class="sxs-lookup"><span data-stu-id="f32de-152">This is not a problem if your recovery strategy is to redeploy after disaster.</span></span> <span data-ttu-id="f32de-153">但是，如果使用暖备份方法来保留容量，则它可能会成为问题。</span><span class="sxs-lookup"><span data-stu-id="f32de-153">However, it might be a problem if you are using the Warm Spare approach to reserve capacity.</span></span> <span data-ttu-id="f32de-154">要正确实现这一点，必须将正确的操作系统磁盘部署到主要位置和辅助位置，而将应用程序数据存储在单独的驱动器上。</span><span class="sxs-lookup"><span data-stu-id="f32de-154">To implement this properly, you must have the correct operating system disk deployed to both the primary and secondary locations, and the application data must be stored on a separate drive.</span></span> <span data-ttu-id="f32de-155">如果可能，请使用这两个位置均可以提供标准的操作系统配置。</span><span class="sxs-lookup"><span data-stu-id="f32de-155">If possible, use a standard operating system configuration that can be provided on both locations.</span></span> <span data-ttu-id="f32de-156">在故障转移后，必须将数据驱动器连接到辅助 DC 中的现有 IaaS VM。</span><span class="sxs-lookup"><span data-stu-id="f32de-156">After a failover, you must then attach the data drive to your existing IaaS VMs in the secondary DC.</span></span> <span data-ttu-id="f32de-157">可以使用 AzCopy 将数据磁盘的快照复制到远程站点。</span><span class="sxs-lookup"><span data-stu-id="f32de-157">Use AzCopy to copy snapshots of the data disk(s) to a remote site.</span></span>
* <span data-ttu-id="f32de-158">**注意异地故障转移多个 VM 磁盘后的潜在一致性问题**。</span><span class="sxs-lookup"><span data-stu-id="f32de-158">**Be aware of potential consistency issues after a geo-failover of multiple VM Disks**.</span></span> <span data-ttu-id="f32de-159">VM 磁盘是作为 Azure 存储 Blob 实现的，具有相同的异地复制特征。</span><span class="sxs-lookup"><span data-stu-id="f32de-159">VM Disks are implemented as Azure Storage blobs, and have the same geo-replication characteristic.</span></span> <span data-ttu-id="f32de-160">除非使用 [Azure 备份](https://azure.microsoft.com/services/backup/)，否则不能保证磁盘间的一致性，因为异地复制是异步进行的，并且是独立复制的。</span><span class="sxs-lookup"><span data-stu-id="f32de-160">Unless [Azure Backup](https://azure.microsoft.com/services/backup/) is used, there are no guarantees of consistency across disks, because geo-replication is asynchronous and replicates independently.</span></span> <span data-ttu-id="f32de-161">可以保证 VM 磁盘在异地故障转移后处于崩溃一致状态，但不能保证磁盘间的一致性。</span><span class="sxs-lookup"><span data-stu-id="f32de-161">Individual VM disks are guaranteed to be in a crash consistent state after a geo-failover, but not consistent across disks.</span></span> <span data-ttu-id="f32de-162">在某些情况下（例如使用磁盘条带化时）可能会产生问题。</span><span class="sxs-lookup"><span data-stu-id="f32de-162">This could cause problems in some cases (for example, in the case of disk striping).</span></span>

## <a name="storage"></a><span data-ttu-id="f32de-163">存储</span><span class="sxs-lookup"><span data-stu-id="f32de-163">Storage</span></span>
### <a name="recovery-by-using-geo-redundant-storage-of-blob-table-queue-and-vm-disk-storage"></a><span data-ttu-id="f32de-164">使用 blob、表、队列和 VM 磁盘存储的异地冗余存储进行恢复</span><span class="sxs-lookup"><span data-stu-id="f32de-164">Recovery by using Geo-Redundant Storage of blob, table, queue and VM disk storage</span></span>
<span data-ttu-id="f32de-165">在 Azure 中，默认情况下，Blob、表、队列和 VM 磁盘都会进行异地复制。</span><span class="sxs-lookup"><span data-stu-id="f32de-165">In Azure, blobs, tables, queues, and VM disks are all geo-replicated by default.</span></span> <span data-ttu-id="f32de-166">这称为异地冗余存储 (GRS)。</span><span class="sxs-lookup"><span data-stu-id="f32de-166">This is referred to as Geo-Redundant Storage (GRS).</span></span> <span data-ttu-id="f32de-167">GRS 会将存储数据复制到几百英里以外特定地理区域中的配对数据中心中。</span><span class="sxs-lookup"><span data-stu-id="f32de-167">GRS replicates storage data to a paired datacenter hundreds of miles apart within a specific geographic region.</span></span> <span data-ttu-id="f32de-168">GRS 旨在提供额外的持久性，以防出现重大的数据中心灾难。</span><span class="sxs-lookup"><span data-stu-id="f32de-168">GRS is designed to provide additional durability in case there is a major datacenter disaster.</span></span> <span data-ttu-id="f32de-169">Microsoft 控制故障转移发生的时间且故障转移限于重大灾难，也就是原始主要位置被视为无法在合理时间内恢复。</span><span class="sxs-lookup"><span data-stu-id="f32de-169">Microsoft controls when failover occurs, and failover is limited to major disasters in which the original primary location is deemed unrecoverable in a reasonable amount of time.</span></span> <span data-ttu-id="f32de-170">在某些情况下，这可能需要几天时间。</span><span class="sxs-lookup"><span data-stu-id="f32de-170">Under some scenarios, this can be several days.</span></span> <span data-ttu-id="f32de-171">尽管同步间隔在服务级别协议中并未提及，但是数据通常在几分钟内完成复制。</span><span class="sxs-lookup"><span data-stu-id="f32de-171">Data is typically replicated within a few minutes, although synchronization interval is not yet covered by a service level agreement.</span></span>

<span data-ttu-id="f32de-172">在异地故障转移时，不会对访问帐户的方式进行更改（URL 和帐户密钥不会更改）。</span><span class="sxs-lookup"><span data-stu-id="f32de-172">In the event of a geo-failover, there will be no change to how the account is accessed (the URL and account key will not change).</span></span> <span data-ttu-id="f32de-173">但是，在故障转移后存储帐户将位于另一个区域。</span><span class="sxs-lookup"><span data-stu-id="f32de-173">The storage account will, however, be in a different region after failover.</span></span> <span data-ttu-id="f32de-174">这可能会影响需要与存储帐户保持区域关系的应用程序。</span><span class="sxs-lookup"><span data-stu-id="f32de-174">This could impact applications that require regional affinity with their storage account.</span></span> <span data-ttu-id="f32de-175">即使服务和应用程序不要求存储帐户位于相同的数据中心，跨数据中心的延迟性和带宽费用也使暂时会流量移到故障转移区域成为一种明智之举。</span><span class="sxs-lookup"><span data-stu-id="f32de-175">Even for services and applications that do not require a storage account in the same datacenter, the cross-datacenter latency and bandwidth charges might be compelling reasons to move traffic to the failover region temporarily.</span></span> <span data-ttu-id="f32de-176">整体的灾难恢复策略可以考虑此项因素。</span><span class="sxs-lookup"><span data-stu-id="f32de-176">This could factor into an overall disaster recovery strategy.</span></span>

<span data-ttu-id="f32de-177">除了 GRS 提供的自动故障转移之外，Azure 还引入了一种服务，让你能够对位于辅助存储位置的数据副本进行读取访问。</span><span class="sxs-lookup"><span data-stu-id="f32de-177">In addition to automatic failover provided by GRS, Azure has introduced a service that gives you read access to the copy of your data in the secondary storage location.</span></span> <span data-ttu-id="f32de-178">这称为读取访问异地冗余存储 (RA-GRS)。</span><span class="sxs-lookup"><span data-stu-id="f32de-178">This is called Read-Access Geo-Redundant Storage (RA-GRS).</span></span>

<span data-ttu-id="f32de-179">有关 GRS 和 RA-GRS 存储的详细信息，请参阅 [Azure 存储复制](/azure/storage/storage-redundancy/)。</span><span class="sxs-lookup"><span data-stu-id="f32de-179">For more information about both GRS and RA-GRS storage, see [Azure Storage replication](/azure/storage/storage-redundancy/).</span></span>

### <a name="geo-replication-region-mappings"></a><span data-ttu-id="f32de-180">异地复制区域映射：</span><span class="sxs-lookup"><span data-stu-id="f32de-180">Geo-Replication region mappings:</span></span>
<span data-ttu-id="f32de-181">必须了解异地复制会将数据复制到哪里，这样才能知道，对于要求与存储保持区域关系的数据，应将其实例部署到哪里。</span><span class="sxs-lookup"><span data-stu-id="f32de-181">It is important to know where your data is geo-replicated, in order to know where to deploy the other instances of your data that require regional affinity with your storage.</span></span> <span data-ttu-id="f32de-182">有关详细信息，请参阅 [Azure 配对区域](/azure/best-practices-availability-paired-regions)。</span><span class="sxs-lookup"><span data-stu-id="f32de-182">For more information see [Azure Paired Regions](/azure/best-practices-availability-paired-regions).</span></span>

### <a name="geo-replication-pricing"></a><span data-ttu-id="f32de-183">异地复制定价：</span><span class="sxs-lookup"><span data-stu-id="f32de-183">Geo-Replication pricing:</span></span>
<span data-ttu-id="f32de-184">异地复制包括在 Azure 存储的当前定价中。</span><span class="sxs-lookup"><span data-stu-id="f32de-184">Geo-replication is included in current pricing for Azure Storage.</span></span> <span data-ttu-id="f32de-185">这称为异地冗余存储 (GRS)。</span><span class="sxs-lookup"><span data-stu-id="f32de-185">This is called Geo-Redundant Storage (GRS).</span></span> <span data-ttu-id="f32de-186">如果不想对数据进行异地复制，可以为帐户禁用异地复制。</span><span class="sxs-lookup"><span data-stu-id="f32de-186">If you do not want your data geo-replicated you can disable geo-replication for your account.</span></span> <span data-ttu-id="f32de-187">这称为本地冗余存储，将按照 GRS 的折扣价格收费。</span><span class="sxs-lookup"><span data-stu-id="f32de-187">This is called Locally Redundant Storage, and it is charged at a discounted price compared to GRS.</span></span>

### <a name="determining-if-a-geo-failover-has-occurred"></a><span data-ttu-id="f32de-188">确定是否发生了异地故障转移</span><span class="sxs-lookup"><span data-stu-id="f32de-188">Determining if a geo-failover has occurred</span></span>
<span data-ttu-id="f32de-189">如果发生了异地故障转移，信息会发布到 [Azure 服务运行状况仪表板](https://azure.microsoft.com/status/)。</span><span class="sxs-lookup"><span data-stu-id="f32de-189">If a geo-failover occurs, this will be posted to the [Azure Service Health Dashboard](https://azure.microsoft.com/status/).</span></span> <span data-ttu-id="f32de-190">但是，应用程序可以通过监视其存储帐户的地理区域，来实施自动的检测方法。</span><span class="sxs-lookup"><span data-stu-id="f32de-190">Applications can implement an automated means of detecting this, however, by monitoring the geo-region for their storage account.</span></span> <span data-ttu-id="f32de-191">这可以用来触发其他恢复操作，如激活存储移往的地理区域中的计算资源。</span><span class="sxs-lookup"><span data-stu-id="f32de-191">This can be used to trigger other recovery operations, such as activation of compute resources in the geo-region where their storage moved to.</span></span> <span data-ttu-id="f32de-192">可使用[获取存储帐户属性](https://msdn.microsoft.com/library/ee460802.aspx)从服务管理 API 来进行查询。</span><span class="sxs-lookup"><span data-stu-id="f32de-192">You can perform a query for this from the service management API, by using [Get Storage Account Properties](https://msdn.microsoft.com/library/ee460802.aspx).</span></span> <span data-ttu-id="f32de-193">相关的属性包括：</span><span class="sxs-lookup"><span data-stu-id="f32de-193">The relevant properties are:</span></span>

    <GeoPrimaryRegion>primary-region</GeoPrimaryRegion>
    <StatusOfPrimary>[Available|Unavailable]</StatusOfPrimary>
    <LastGeoFailoverTime>DateTime</LastGeoFailoverTime>
    <GeoSecondaryRegion>secondary-region</GeoSecondaryRegion>
    <StatusOfSecondary>[Available|Unavailable]</StatusOfSecondary>

### <a name="vm-disks-and-geo-failover"></a><span data-ttu-id="f32de-194">VM 磁盘和异地故障转移</span><span class="sxs-lookup"><span data-stu-id="f32de-194">VM disks and geo-failover</span></span>
<span data-ttu-id="f32de-195">如有关 VM 磁盘的部分中所述，故障转移后无法保证 VM 磁盘之间的数据一致性。</span><span class="sxs-lookup"><span data-stu-id="f32de-195">As discussed in the section on VM disks, there are no guarantees for data consistency across VM disks after a failover.</span></span> <span data-ttu-id="f32de-196">为确保备份正确，应使用 Data Protection Manager 等备份产品来备份和还原应用程序数据。</span><span class="sxs-lookup"><span data-stu-id="f32de-196">To ensure correctness of backups, a backup product such as Data Protection Manager should be used to back up and restore application data.</span></span>

## <a name="database"></a><span data-ttu-id="f32de-197">数据库</span><span class="sxs-lookup"><span data-stu-id="f32de-197">Database</span></span>
### <a name="sql-database"></a><span data-ttu-id="f32de-198">SQL 数据库</span><span class="sxs-lookup"><span data-stu-id="f32de-198">SQL Database</span></span>
<span data-ttu-id="f32de-199">Azure SQL 数据库提供两种类型的恢复：异地还原和活动异地复制。</span><span class="sxs-lookup"><span data-stu-id="f32de-199">Azure SQL Database provides two types of recovery: Geo-Restore and Active Geo-Replication.</span></span>

#### <a name="geo-restore"></a><span data-ttu-id="f32de-200">异地还原</span><span class="sxs-lookup"><span data-stu-id="f32de-200">Geo-Restore</span></span>
<span data-ttu-id="f32de-201">[异地还原](/azure/sql-database/sql-database-recovery-using-backups/#geo-restore)也适用于基本、标准和高级数据库。</span><span class="sxs-lookup"><span data-stu-id="f32de-201">[Geo-Restore](/azure/sql-database/sql-database-recovery-using-backups/#geo-restore) is also available with Basic, Standard, and Premium databases.</span></span> <span data-ttu-id="f32de-202">当数据库由于它所在的区域发生事故而不可用时，异地还原会提供默认的恢复选项。</span><span class="sxs-lookup"><span data-stu-id="f32de-202">It provides the default recovery option when the database is unavailable because of an incident in the region where your database is hosted.</span></span> <span data-ttu-id="f32de-203">与时间点还原一样，异地还原依赖于异地冗余的 Azure 存储中的数据库备份。</span><span class="sxs-lookup"><span data-stu-id="f32de-203">Similar to Point-In-Time Restore, Geo-Restore relies on database backups in geo-redundant Azure storage.</span></span> <span data-ttu-id="f32de-204">它会从异地复制的备份副本中还原，因此可以灵活应对主要区域中的存储中断。</span><span class="sxs-lookup"><span data-stu-id="f32de-204">It restores from the geo-replicated backup copy, and therefore is resilient to the storage outages in the primary region.</span></span> <span data-ttu-id="f32de-205">有关详细信息，请参阅[还原 Azure SQL 数据库或故障转移到辅助数据库](/azure/sql-database/sql-database-disaster-recovery/)。</span><span class="sxs-lookup"><span data-stu-id="f32de-205">For more details, see [Restore an Azure SQL Database or failover to a secondary](/azure/sql-database/sql-database-disaster-recovery/).</span></span>

#### <a name="active-geo-replication"></a><span data-ttu-id="f32de-206">活动异地复制</span><span class="sxs-lookup"><span data-stu-id="f32de-206">Active Geo-Replication</span></span>
<span data-ttu-id="f32de-207">[活动异地复制](/azure/sql-database/sql-database-geo-replication-overview/)适用于所有数据库层。</span><span class="sxs-lookup"><span data-stu-id="f32de-207">[Active Geo-Replication](/azure/sql-database/sql-database-geo-replication-overview/) is available for all database tiers.</span></span> <span data-ttu-id="f32de-208">它专为恢复要求超出了异地还原的能力的应用程序而设计。</span><span class="sxs-lookup"><span data-stu-id="f32de-208">It’s designed for applications that have more aggressive recovery requirements than Geo-Restore can offer.</span></span> <span data-ttu-id="f32de-209">使用活动异地复制，最多可以在不同区域中的服务器上创建四个可读辅助数据库。</span><span class="sxs-lookup"><span data-stu-id="f32de-209">Using Active Geo-Replication, you can create up to four readable secondaries on servers in different regions.</span></span> <span data-ttu-id="f32de-210">可以启动到任何辅助数据库的故障转移。</span><span class="sxs-lookup"><span data-stu-id="f32de-210">You can initiate failover to any of the secondaries.</span></span> <span data-ttu-id="f32de-211">此外，活动异地复制可用于支持应用程序升级或重定位方案，以及只读工作负荷的负载均衡。</span><span class="sxs-lookup"><span data-stu-id="f32de-211">In addition, Active Geo-Replication can be used to support the application upgrade or relocation scenarios, as well as load balancing for read-only workloads.</span></span> <span data-ttu-id="f32de-212">有关详细信息，请参阅[配置异地复制](/azure/sql-database/sql-database-geo-replication-portal/)和[故障转移到辅助数据库](/azure/sql-database/sql-database-geo-replication-failover-portal/)。</span><span class="sxs-lookup"><span data-stu-id="f32de-212">For details, see [configure Geo-Replication](/azure/sql-database/sql-database-geo-replication-portal/) and to [fail over to the secondary database](/azure/sql-database/sql-database-geo-replication-failover-portal/).</span></span> <span data-ttu-id="f32de-213">有关如何设计和实现应用程序和应用程序升级而无需停机的详细信息，请参阅[使用 SQL 数据库中的活动异地复制功能为云灾难恢复设计应用程序](/azure/sql-database/sql-database-designing-cloud-solutions-for-disaster-recovery/)和[使用 SQL 数据库活动异地复制管理云应用程序的滚动升级](/azure/sql-database/sql-database-manage-application-rolling-upgrade/)。</span><span class="sxs-lookup"><span data-stu-id="f32de-213">Refer to [Design an application for cloud disaster recovery using Active Geo-Replication in SQL Database](/azure/sql-database/sql-database-designing-cloud-solutions-for-disaster-recovery/) and [Managing rolling upgrades of cloud applications using SQL Database Active Geo-Replication](/azure/sql-database/sql-database-manage-application-rolling-upgrade/) for details on how to design and implement applications and applications upgrade without downtime.</span></span>

### <a name="sql-server-on-virtual-machines"></a><span data-ttu-id="f32de-214">虚拟机上的 SQL Server</span><span class="sxs-lookup"><span data-stu-id="f32de-214">SQL Server on Virtual Machines</span></span>
<span data-ttu-id="f32de-215">可以使用各种选项对 Azure 虚拟机中运行的 SQL Server 2012（和更高版本）实现恢复和高可用性目的。</span><span class="sxs-lookup"><span data-stu-id="f32de-215">A variety of options are available for recovery and high availability for SQL Server 2012 (and later) running in Azure Virtual Machines.</span></span> <span data-ttu-id="f32de-216">有关详细信息，请参阅 [Azure 虚拟机中 SQL Server 的高可用性和灾难恢复](/azure/virtual-machines/windows/sql/virtual-machines-windows-sql-high-availability-dr/)。</span><span class="sxs-lookup"><span data-stu-id="f32de-216">For more information, see [High availability and disaster recovery for SQL Server in Azure Virtual Machines](/azure/virtual-machines/windows/sql/virtual-machines-windows-sql-high-availability-dr/).</span></span>

## <a name="other-azure-platform-services"></a><span data-ttu-id="f32de-217">其他 Azure 平台服务</span><span class="sxs-lookup"><span data-stu-id="f32de-217">Other Azure platform services</span></span>
<span data-ttu-id="f32de-218">在尝试于多个 Azure 区域运行云服务时，必须考虑每个依赖项的含义。</span><span class="sxs-lookup"><span data-stu-id="f32de-218">When attempting to run your cloud service in multiple Azure regions, you must consider the implications for each of your dependencies.</span></span> <span data-ttu-id="f32de-219">在以下部分中，该服务特定的指南假设你在备用 Azure 数据中心中一定使用相同的 Azure 服务。</span><span class="sxs-lookup"><span data-stu-id="f32de-219">In the following sections, the service-specific guidance assumes that you must use the same Azure service in an alternate Azure datacenter.</span></span> <span data-ttu-id="f32de-220">这同时涉及到配置和数据复制任务。</span><span class="sxs-lookup"><span data-stu-id="f32de-220">This involves both configuration and data-replication tasks.</span></span>

> [!NOTE]
> <span data-ttu-id="f32de-221">在某些情况下，这些步骤有助于缓解服务特定的中断，而不是整个数据中心的中断事件。</span><span class="sxs-lookup"><span data-stu-id="f32de-221">In some cases, these steps can help to mitigate a service-specific outage rather than an entire datacenter event.</span></span> <span data-ttu-id="f32de-222">从应用程序的角度而言，服务特定的中断可能只是受到限制，需要临时会服务迁移到备用 Azure 区域。</span><span class="sxs-lookup"><span data-stu-id="f32de-222">From the application perspective, a service-specific outage might be just as limiting and would require temporarily migrating the service to an alternate Azure region.</span></span>
> 
> 

### <a name="service-bus"></a><span data-ttu-id="f32de-223">服务总线</span><span class="sxs-lookup"><span data-stu-id="f32de-223">Service Bus</span></span>
<span data-ttu-id="f32de-224">Azure 服务总线使用不跨越 Azure 区域的唯一命名空间。</span><span class="sxs-lookup"><span data-stu-id="f32de-224">Azure Service Bus uses a unique namespace that does not span Azure regions.</span></span> <span data-ttu-id="f32de-225">因此，首要要求是在备用区域中设置必要的服务总线命名空间。</span><span class="sxs-lookup"><span data-stu-id="f32de-225">So the first requirement is to setup the necessary service bus namespaces in the alternate region.</span></span> <span data-ttu-id="f32de-226">但是，对于排队消息的持久性，也有一些注意事项。</span><span class="sxs-lookup"><span data-stu-id="f32de-226">However, there are also considerations for the durability of the queued messages.</span></span> <span data-ttu-id="f32de-227">有几种在 Azure 区域间复制消息的策略。</span><span class="sxs-lookup"><span data-stu-id="f32de-227">There are several strategies for replicating messages across Azure regions.</span></span> <span data-ttu-id="f32de-228">有关这些复制策略和其他灾难恢复策略的详细信息，请参阅[使应用程序免受服务总线中断和灾难影响的最佳实践](/azure/service-bus-messaging/service-bus-outages-disasters/)。</span><span class="sxs-lookup"><span data-stu-id="f32de-228">For the details on these replication strategies and other disaster recovery strategies, see [Best practices for insulating applications against Service Bus outages and disasters](/azure/service-bus-messaging/service-bus-outages-disasters/).</span></span> <span data-ttu-id="f32de-229">有关其他可用性注意事项，请参阅[服务总线（可用性）](recovery-local-failures.md#other-azure-platform-services)。</span><span class="sxs-lookup"><span data-stu-id="f32de-229">For other availability considerations, see [Service Bus (Availability)](recovery-local-failures.md#other-azure-platform-services).</span></span>

### <a name="app-service"></a><span data-ttu-id="f32de-230">应用服务</span><span class="sxs-lookup"><span data-stu-id="f32de-230">App Service</span></span>
<span data-ttu-id="f32de-231">要将 Azure 应用服务应用程序（如 Web 应用或移动应用）迁移到辅助 Azure 区域，必须有该网站可供发布的备份。</span><span class="sxs-lookup"><span data-stu-id="f32de-231">To migrate an Azure App Service application, such as Web Apps or Mobile Apps, to a secondary Azure region, you must have a backup of the website available for publishing.</span></span> <span data-ttu-id="f32de-232">如果中断不涉及整个 Azure 数据中心，则也许可以使用 FTP 下载站点内容的最新备份。</span><span class="sxs-lookup"><span data-stu-id="f32de-232">If the outage does not involve the entire Azure datacenter, it might be possible to use FTP to download a recent backup of the site content.</span></span> <span data-ttu-id="f32de-233">然后，在备用区域创建新的应用，除非之前已执行此操作来保留容量。</span><span class="sxs-lookup"><span data-stu-id="f32de-233">Then create a new app in the alternate region, unless you have previously done this to reserve capacity.</span></span> <span data-ttu-id="f32de-234">将站点发布到新区域，然后进行必要的配置更改。</span><span class="sxs-lookup"><span data-stu-id="f32de-234">Publish the site to the new region, and make any necessary configuration changes.</span></span> <span data-ttu-id="f32de-235">这些更改可能包括数据库连接字符串或其他区域特定的设置。</span><span class="sxs-lookup"><span data-stu-id="f32de-235">These changes could include database connection strings or other region-specific settings.</span></span> <span data-ttu-id="f32de-236">如有必要，请添加站点的 SSL 证书，并更改 DNS CNAME 记录，以使自定义域名指向重新部署的 Azure Web 应用 URL。</span><span class="sxs-lookup"><span data-stu-id="f32de-236">If necessary, add the site’s SSL certificate and change the DNS CNAME record so that the custom domain name points to the redeployed Azure Web App URL.</span></span>

### <a name="hdinsight"></a><span data-ttu-id="f32de-237">HDInsight</span><span class="sxs-lookup"><span data-stu-id="f32de-237">HDInsight</span></span>
<span data-ttu-id="f32de-238">与 HDInsight 关联的数据默认存储在 Azure Blob 存储中。</span><span class="sxs-lookup"><span data-stu-id="f32de-238">The data associated with HDInsight is stored by default in Azure Blob Storage.</span></span> <span data-ttu-id="f32de-239">HDInsight 要求 Hadoop 群集处理 MapReduce 作业必须与包含所分析数据的存储帐户位于同一区域中。</span><span class="sxs-lookup"><span data-stu-id="f32de-239">HDInsight requires that a Hadoop cluster processing MapReduce jobs must be co-located in the same region as the storage account that contains the data being analyzed.</span></span> <span data-ttu-id="f32de-240">假如你使用可用于 Azure 存储的区域异地复制功能，则如果主要区域因为某些原因而无法使用，可以访问复制到次要区域的数据。</span><span class="sxs-lookup"><span data-stu-id="f32de-240">Provided you use the geo-replication feature available to Azure Storage, you can access your data in the secondary region where the data was replicated if for some reason the primary region is no longer available.</span></span> <span data-ttu-id="f32de-241">可以在数据复制到的区域中创建新的 Hadoop 群集并继续处理这些数据。</span><span class="sxs-lookup"><span data-stu-id="f32de-241">You can create a new Hadoop cluster in the region where the data has been replicated and continue processing it.</span></span> <span data-ttu-id="f32de-242">有关其他可用性注意事项，请参阅 [HDInsight（可用性）](recovery-local-failures.md#other-azure-platform-services)。</span><span class="sxs-lookup"><span data-stu-id="f32de-242">For other availability considerations, see [HDInsight (Availability)](recovery-local-failures.md#other-azure-platform-services).</span></span>

### <a name="sql-reporting"></a><span data-ttu-id="f32de-243">SQL 报告</span><span class="sxs-lookup"><span data-stu-id="f32de-243">SQL Reporting</span></span>
<span data-ttu-id="f32de-244">目前，要从 Azure 区域的损失中恢复，需要有多个位于其他 Azure 区域的 SQL 报告实例。</span><span class="sxs-lookup"><span data-stu-id="f32de-244">At this time, recovering from the loss of an Azure region requires multiple SQL Reporting instances in different Azure regions.</span></span> <span data-ttu-id="f32de-245">这些 SQL 报告实例应当访问相同的数据，且该数据应当有自己的恢复计划，来处理灾难情况。</span><span class="sxs-lookup"><span data-stu-id="f32de-245">These SQL Reporting instances should access the same data, and that data should have its own recovery plan in the event of a disaster.</span></span> <span data-ttu-id="f32de-246">还可以为每个报表维护 RDL 文件的外部备份副本。</span><span class="sxs-lookup"><span data-stu-id="f32de-246">You can also maintain external backup copies of the RDL file for each report.</span></span>

### <a name="media-services"></a><span data-ttu-id="f32de-247">媒体服务</span><span class="sxs-lookup"><span data-stu-id="f32de-247">Media Services</span></span>
<span data-ttu-id="f32de-248">Azure 媒体服务对于编码和流有不同的恢复方法。</span><span class="sxs-lookup"><span data-stu-id="f32de-248">Azure Media Services has a different recovery approach for encoding and streaming.</span></span> <span data-ttu-id="f32de-249">通常，在区域中断期间，流更为重要。</span><span class="sxs-lookup"><span data-stu-id="f32de-249">Typically, streaming is more critical during a regional outage.</span></span> <span data-ttu-id="f32de-250">为对此做好准备，应在两个不同的 Azure 区域中各有一个媒体服务帐户。</span><span class="sxs-lookup"><span data-stu-id="f32de-250">To prepare for this, you should have a Media Services account in two different Azure regions.</span></span> <span data-ttu-id="f32de-251">这两个区域都应有编码的内容。</span><span class="sxs-lookup"><span data-stu-id="f32de-251">The encoded content should be located in both regions.</span></span> <span data-ttu-id="f32de-252">在故障期间，可以将流式流量重定向到备用区域。</span><span class="sxs-lookup"><span data-stu-id="f32de-252">During a failure, you can redirect the streaming traffic to the alternate region.</span></span> <span data-ttu-id="f32de-253">编码可在任意 Azure 区域执行。</span><span class="sxs-lookup"><span data-stu-id="f32de-253">Encoding can be performed in any Azure region.</span></span> <span data-ttu-id="f32de-254">如果编码对时间敏感，如在现场活动处理期间，必须准备好如何在故障期间向备用数据中心提交代码。</span><span class="sxs-lookup"><span data-stu-id="f32de-254">If encoding is time-sensitive, for example during live event processing, you must be prepared to submit jobs to an alternate datacenter during failures.</span></span>

### <a name="virtual-network"></a><span data-ttu-id="f32de-255">虚拟网络</span><span class="sxs-lookup"><span data-stu-id="f32de-255">Virtual network</span></span>
<span data-ttu-id="f32de-256">配置文件是在备用 Azure 区域设置虚拟网络的最快速方式。</span><span class="sxs-lookup"><span data-stu-id="f32de-256">Configuration files provide the quickest way to set up a virtual network in an alternate Azure region.</span></span> <span data-ttu-id="f32de-257">在主要 Azure 区域配置虚拟网络之后，将当前网络的[虚拟网络设置导出](/azure/virtual-network/virtual-networks-create-vnet-classic-portal/)到网络配置文件。</span><span class="sxs-lookup"><span data-stu-id="f32de-257">After configuring the virtual network in the primary Azure region, [export the virtual network settings](/azure/virtual-network/virtual-networks-create-vnet-classic-portal/) for the current network to a network configuration file.</span></span> <span data-ttu-id="f32de-258">如果主要区域发生中断，则从存储的配置文件[还原虚拟网络](/azure/virtual-network/virtual-networks-create-vnet-classic-portal/)。</span><span class="sxs-lookup"><span data-stu-id="f32de-258">In the event of an outage in the primary region, [restore the virtual network](/azure/virtual-network/virtual-networks-create-vnet-classic-portal/) from the stored configuration file.</span></span> <span data-ttu-id="f32de-259">然后，配置其他云服务、虚拟机或跨界设置以使用新的虚拟网络。</span><span class="sxs-lookup"><span data-stu-id="f32de-259">Then configure other cloud services, virtual machines, or cross-premises settings to work with the new virtual network.</span></span>

## <a name="checklists-for-disaster-recovery"></a><span data-ttu-id="f32de-260">灾难恢复清单</span><span class="sxs-lookup"><span data-stu-id="f32de-260">Checklists for disaster recovery</span></span>
## <a name="cloud-services-checklist"></a><span data-ttu-id="f32de-261">云服务清单</span><span class="sxs-lookup"><span data-stu-id="f32de-261">Cloud Services checklist</span></span>
1. <span data-ttu-id="f32de-262">查看本文档的“云服务”部分。</span><span class="sxs-lookup"><span data-stu-id="f32de-262">Review the Cloud Services section of this document.</span></span>
2. <span data-ttu-id="f32de-263">创建跨区域的灾难恢复策略。</span><span class="sxs-lookup"><span data-stu-id="f32de-263">Create a cross-region disaster recovery strategy.</span></span>
3. <span data-ttu-id="f32de-264">了解在备用区域保留容量的利弊。</span><span class="sxs-lookup"><span data-stu-id="f32de-264">Understand trade-offs in reserving capacity in alternate regions.</span></span>
4. <span data-ttu-id="f32de-265">使用流量路由工具，如 Azure 流量管理器。</span><span class="sxs-lookup"><span data-stu-id="f32de-265">Use traffic routing tools, such as Azure Traffic Manager.</span></span>

## <a name="virtual-machines-checklist"></a><span data-ttu-id="f32de-266">虚拟机清单</span><span class="sxs-lookup"><span data-stu-id="f32de-266">Virtual Machines checklist</span></span>
1. <span data-ttu-id="f32de-267">查看本文档的“虚拟机”部分。</span><span class="sxs-lookup"><span data-stu-id="f32de-267">Review the Virtual Machines section of this document.</span></span>
2. <span data-ttu-id="f32de-268">使用 [Azure 备份](https://azure.microsoft.com/services/backup/)创建应用程序一致的跨区域备份。</span><span class="sxs-lookup"><span data-stu-id="f32de-268">Use [Azure Backup](https://azure.microsoft.com/services/backup/) to create application consistent backups across regions.</span></span>

## <a name="storage-checklist"></a><span data-ttu-id="f32de-269">存储清单</span><span class="sxs-lookup"><span data-stu-id="f32de-269">Storage checklist</span></span>
1. <span data-ttu-id="f32de-270">查看本文档的“存储”部分。</span><span class="sxs-lookup"><span data-stu-id="f32de-270">Review the Storage section of this document.</span></span>
2. <span data-ttu-id="f32de-271">不要禁用存储资源的异地复制。</span><span class="sxs-lookup"><span data-stu-id="f32de-271">Do not disable geo-replication of storage resources.</span></span>
3. <span data-ttu-id="f32de-272">了解故障转移时用于异地复制的备用区域。</span><span class="sxs-lookup"><span data-stu-id="f32de-272">Understand alternate region for geo-replication in the event of failover.</span></span>
4. <span data-ttu-id="f32de-273">为用户控制的故障转移策略创建自定义备份策略。</span><span class="sxs-lookup"><span data-stu-id="f32de-273">Create custom backup strategies for user-controlled failover strategies.</span></span>

## <a name="sql-database-checklist"></a><span data-ttu-id="f32de-274">SQL 数据库清单</span><span class="sxs-lookup"><span data-stu-id="f32de-274">SQL Database checklist</span></span>
1. <span data-ttu-id="f32de-275">查看本文档的“SQL 数据库”部分。</span><span class="sxs-lookup"><span data-stu-id="f32de-275">Review the SQL Database section of this document.</span></span>
2. <span data-ttu-id="f32de-276">根据情况使用[异地还原](/azure/sql-database/sql-database-recovery-using-backups/#geo-restore)或[异地复制](/azure/sql-database/sql-database-geo-replication-overview/)。</span><span class="sxs-lookup"><span data-stu-id="f32de-276">Use [Geo-Restore](/azure/sql-database/sql-database-recovery-using-backups/#geo-restore) or [Geo-Replication](/azure/sql-database/sql-database-geo-replication-overview/) as appropriate.</span></span>

## <a name="sql-server-on-virtual-machines-checklist"></a><span data-ttu-id="f32de-277">虚拟机上的 SQL Server 清单</span><span class="sxs-lookup"><span data-stu-id="f32de-277">SQL Server on Virtual Machines checklist</span></span>
1. <span data-ttu-id="f32de-278">查看本文档的“虚拟机上的 SQL Server”部分。</span><span class="sxs-lookup"><span data-stu-id="f32de-278">Review the SQL Server on Virtual Machines section of this document.</span></span>
2. <span data-ttu-id="f32de-279">使用跨区域 AlwaysOn 可用性组或数据库镜像。</span><span class="sxs-lookup"><span data-stu-id="f32de-279">Use cross-region AlwaysOn Availability Groups or database mirroring.</span></span>
3. <span data-ttu-id="f32de-280">也可以使用备份和还原到 Blob 存储。</span><span class="sxs-lookup"><span data-stu-id="f32de-280">Alternately use backup and restore to blob storage.</span></span>

## <a name="service-bus-checklist"></a><span data-ttu-id="f32de-281">服务总线清单</span><span class="sxs-lookup"><span data-stu-id="f32de-281">Service Bus checklist</span></span>
1. <span data-ttu-id="f32de-282">查看本文档的“服务总线”部分。</span><span class="sxs-lookup"><span data-stu-id="f32de-282">Review the Service Bus section of this document.</span></span>
2. <span data-ttu-id="f32de-283">在备用区域中配置服务总线命名空间。</span><span class="sxs-lookup"><span data-stu-id="f32de-283">Configure a Service Bus namespace in an alternate region.</span></span>
3. <span data-ttu-id="f32de-284">考虑自定义跨区域消息的复制策略。</span><span class="sxs-lookup"><span data-stu-id="f32de-284">Consider custom replication strategies for messages across regions.</span></span>

## <a name="app-service-checklist"></a><span data-ttu-id="f32de-285">应用服务清单</span><span class="sxs-lookup"><span data-stu-id="f32de-285">App Service checklist</span></span>
1. <span data-ttu-id="f32de-286">查看本文档的“应用服务”部分。</span><span class="sxs-lookup"><span data-stu-id="f32de-286">Review the App Service section of this document.</span></span>
2. <span data-ttu-id="f32de-287">在主要区域外部维护站点备份。</span><span class="sxs-lookup"><span data-stu-id="f32de-287">Maintain site backups outside of the primary region.</span></span>
3. <span data-ttu-id="f32de-288">如果发生局部中断，则尝试使用 FTP 检索当前站点。</span><span class="sxs-lookup"><span data-stu-id="f32de-288">If outage is partial, attempt to retrieve current site with FTP.</span></span>
4. <span data-ttu-id="f32de-289">计划将站点部署到备用区域中的新站点或现有站点。</span><span class="sxs-lookup"><span data-stu-id="f32de-289">Plan to deploy the site to new or existing site in an alternate region.</span></span>
5. <span data-ttu-id="f32de-290">计划对应用程序和 DNS CNAME 记录的配置更改。</span><span class="sxs-lookup"><span data-stu-id="f32de-290">Plan configuration changes for both application and DNS CNAME records.</span></span>

## <a name="hdinsight-checklist"></a><span data-ttu-id="f32de-291">HDInsight 清单</span><span class="sxs-lookup"><span data-stu-id="f32de-291">HDInsight checklist</span></span>
1. <span data-ttu-id="f32de-292">查看本文档的“HDInsight”部分。</span><span class="sxs-lookup"><span data-stu-id="f32de-292">Review the HDInsight section of this document.</span></span>
2. <span data-ttu-id="f32de-293">使用复制的数据在区域中创建新的 Hadoop 群集。</span><span class="sxs-lookup"><span data-stu-id="f32de-293">Create a new Hadoop cluster in the region with replicated data.</span></span>

## <a name="sql-reporting-checklist"></a><span data-ttu-id="f32de-294">SQL 报告清单</span><span class="sxs-lookup"><span data-stu-id="f32de-294">SQL Reporting checklist</span></span>
1. <span data-ttu-id="f32de-295">查看本文档的“SQL 报告”部分。</span><span class="sxs-lookup"><span data-stu-id="f32de-295">Review the SQL Reporting section of this document.</span></span>
2. <span data-ttu-id="f32de-296">在另一个区域维护备用 SQL 报告实例。</span><span class="sxs-lookup"><span data-stu-id="f32de-296">Maintain an alternate SQL Reporting instance in a different region.</span></span>
3. <span data-ttu-id="f32de-297">维护单独的计划以将目标复制到该区域。</span><span class="sxs-lookup"><span data-stu-id="f32de-297">Maintain a separate plan to replicate the target to that region.</span></span>

## <a name="media-services-checklist"></a><span data-ttu-id="f32de-298">媒体服务清单</span><span class="sxs-lookup"><span data-stu-id="f32de-298">Media Services checklist</span></span>
1. <span data-ttu-id="f32de-299">查看本文档的“媒体服务”部分。</span><span class="sxs-lookup"><span data-stu-id="f32de-299">Review the Media Services section of this document.</span></span>
2. <span data-ttu-id="f32de-300">在备用区域创建媒体服务帐户。</span><span class="sxs-lookup"><span data-stu-id="f32de-300">Create a Media Services account in an alternate region.</span></span>
3. <span data-ttu-id="f32de-301">在两个区域对相同的内容进行编码，以支持流式故障转移。</span><span class="sxs-lookup"><span data-stu-id="f32de-301">Encode the same content in both regions to support streaming failover.</span></span>
4. <span data-ttu-id="f32de-302">在发生服务中断时，将编码作业提交到备用区域。</span><span class="sxs-lookup"><span data-stu-id="f32de-302">Submit encoding jobs to an alternate region in the event of a service disruption.</span></span>

## <a name="virtual-network-checklist"></a><span data-ttu-id="f32de-303">虚拟网络清单</span><span class="sxs-lookup"><span data-stu-id="f32de-303">Virtual Network checklist</span></span>
1. <span data-ttu-id="f32de-304">查看本文档的“虚拟网络”部分。</span><span class="sxs-lookup"><span data-stu-id="f32de-304">Review the Virtual Network section of this document.</span></span>
2. <span data-ttu-id="f32de-305">使用导出的虚拟网络设置，在另一个区域重新创建该虚拟网络。</span><span class="sxs-lookup"><span data-stu-id="f32de-305">Use exported virtual network settings to re-create it in another region.</span></span>

