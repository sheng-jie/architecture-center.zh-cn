---
title: 选择适当的数据存储
description: 在 Azure 中选择数据存储的概述
author: MikeWasson
ms.openlocfilehash: 4836ae1997f86d35d8ab8aa66bbc63b4ef826d23
ms.sourcegitcommit: 85334ab0ccb072dac80de78aa82bcfa0f0044d3f
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/11/2018
ms.locfileid: "35252628"
---
# <a name="choose-the-right-data-store"></a>选择适当的数据存储

现代业务系统必须管理日益庞大的数据。 数据可能是从外部服务引入、由系统本身生成或者用户创建的。 这些数据集可能具有截然不同的特征和处理要求。 企业可以使用数据来评估趋势、触发业务过程、审核其运营、分析客户行为，等等。 

这种异构性意味着单一数据存储通常不是最佳的方案。 相反，更好的做法往往将不同类型的数据存储在不同的数据存储中，每个数据存储专注于处理特定的工作负荷或使用模式。 术语“多语言持久性”用于描述混合使用多种数据存储技术的解决方案。

根据要求选择适当的数据存储是一项关键设计决策。 我们真正可以从数百种 SQL 和 NoSQL 数据库实现中进行选择。 数据存储通常根据它们将数据结构化的方式以及支持的操作类型分类。 本文介绍几种最常见的存储模型。 请注意，某种特定的数据存储技术可能支持多个存储模型。 例如，关系数据库管理系统 (RDBMS) 可能还支持键/值或图形存储。 实际上，行业中出现了一种所谓“多模”支持的总体趋势，即单个数据库系统支持多个模型。 但是，在较高层面上了解不同的模型仍然很有帮助。 

并非给定类别中的所有数据存储都提供相同的功能集。 大多数数据存储提供服务器端功能用于查询和处理数据。 有时，此功能已内置在数据存储引擎中。 在其他情况下，数据存储和处理功能是分离的，另外，可能还有一些选项可用于执行处理和分析。 数据存储还支持不同的编程和管理接口。 

一般而言，应该先考虑哪种存储模型最符合要求。 然后，根据功能集、成本和易管理性等因素，考虑该类别中的特定数据存储。

## <a name="relational-database-management-systems"></a>关系数据库管理系统

关系数据库可将数据组织成一系列包含行与列的二维表。 每个表包含自身的列，表中的每个行具有相同的列集。 此模型以数学为基础，大多数供应商提供结构化查询语言 (SQL) 的方言用于检索和管理数据。 RDBMS 通常实施一个事务一致性机制，该机制遵守用于更新信息的 ACID（原子性、一致性、隔离性、持久性）模型。 

RDBMS 通常支持写时架构模型，其中的数据结构已提前定义，所有读取或写入操作必须使用该架构。 这与大多数 NoSQL 数据存储相反，尤其是键/值类型方面，其中，读时架构模型假设客户端针对传出数据库的数据施加其自身的解释性架构，并且对写入的数据格式不可知。

当强一致性保证很重要时，RDBMS 非常有用 &mdash; 其中的所有更改都是原子性的，事务始终可让数据保持一致状态。 但是，底层结构会将存储和处理工作负荷分散在不同的计算机之间，因此不利于横向扩展。 此外，必须遵循规范化过程将 RDBMS 中存储的信息放入关系结构。 尽管此过程易于理解，但可能导致效率低下，因为需要在单独的表中将逻辑实体拆解为实体，然后在运行查询时重组数据。 

相关的 Azure 服务： 

- [Azure SQL 数据库][sql-db]
- [Azure Database for MySQL][mysql]
- [Azure Database for PostgreSQL][postgres]

## <a name="keyvalue-stores"></a>键/值存储

键/值存储实质上是一个大型哈希表。 将每个数据值与唯一的键关联后，键/值存储会使用此键通过相应的哈希函数来存储数据。 选择的哈希函数可在整个数据存储中均匀分配哈希键。 

大多数键/值存储仅支持简单的查询、插入和删除操作。 若要修改某个值（修改一部分或整个值），应用程序必须覆盖整个值的现有数据。 在大多数实现中，读取或写入单个值是原子操作。 如果值较大，写入操作可能需要一段时间。 

应用程序可将任意数据存储为一组值，不过，某些键/值存储会对值的最大大小施加限制。 存储的值对存储系统软件不透明。 应用程序必须提供并解释所有架构信息。 从本质上讲，值是 Blob，键/值存储只是根据键检索或存储值。 

![](./images/key-value.png)

键/值存储已针对执行简单查找的应用程序进行高度优化，但不太适合用于需要跨不同键/值存储查询数据的系统。 另外，对于必须按值执行查询，而不只是基于键执行查找的情况，键/值存储未经过优化。 例如，对于关系数据库，可以使用 WHERE 子句查找记录，但键/值存储通常不会针对值提供此类查找功能。

单个键/值存储就具有极高的可伸缩性，因为数据存储可在独立计算机上的多个节点之间轻松分配数据。 

相关的 Azure 服务： 

- [Cosmos DB][cosmosdb]
- [Azure Redis 缓存][redis-cache]

## <a name="document-databases"></a>文档数据库

文档数据库在概念上类似于键/值存储，不过，它存储的是命名字段和数据的集合（称为文档），其中的每个存储项可能是简单的标量项，也可能是列表和子集合等复合元素。 可通过多种方式将文档字段中的数据编码，包括 XML、YAML、JSON、BSON，甚至存储为纯文本。 与键/值存储不同，文档中的字段会向存储管理系统公开，使应用程序能够使用这些字段中的值查询和筛选数据。 

通常，文档包含实体的整个数据。 至于实体由哪些项构成，则取决于所用的应用程序。 例如，实体可能包含客户和/或订单的详细信息。 单个文档可以包含要在 RDBMS 中多个关系表之间分散的信息。 

文档存储不要求所有文档具有相同的结构。 这种自由格式方法提供了极大的灵活性。 随着业务要求发生变化，应用程序可将不同的数据存储在文档中。

![](./images/document.png)

应用程序可以使用文档键检索文档。 文档键是文档的唯一标识符，通常已经过哈希处理，可帮助均匀分配数据。 某些文档数据库可自动创建文档键。 还有一些文档数据库允许指定要用作键的文档属性。 应用程序还可以基于一个或多个字段的值查询文档。 有些文档数据库支持索引，从而有助于根据一个或多个已编制索引的字段快速查找文档。 

许多文档数据库支持就地更新，使应用程序能够在不重写整个文档的情况下修改文档中特定字段的值。 基于单个文档中的多个字段执行的读取和写入操作通常是原子性的。

相关的 Azure 服务：[Cosmos DB][cosmosdb]

## <a name="graph-databases"></a>图形数据库

图形数据库存储两种类型的信息：节点和边缘。 可将节点视为实体。 边缘指定节点之间的关系。 节点和边缘都可以包含一些属性用于提供有关该节点或边缘的信息（类似于表中的列）。 边缘还可以包含一个方向用于指示关系的性质。

图形数据库的用途是让应用程序有效执行需遍历节点和边缘网络的查询，以及分析实体之间的关系。 下图显示了一个已结构化为图形的组织人员数据库。 实体为员工和部门，边缘指示隶属关系以及员工所在的部门。 在此图形中，边缘上的箭头显示关系的方向。
 
![](./images/graph.png)

使用此结构可以简单直接地执行类似于“查找 Sarah 的直接或间接下属”或“谁与 John 在同一个部门工作？”的查询。 对于包含大量实体和关系的大型图形，可以极快地执行非常复杂的分析。 多个图形数据库提供一种可用于高效遍历关系网络的查询语言。 

相关的 Azure 服务：[Cosmos DB][cosmosdb]

## <a name="column-family-databases"></a>列系列数据库

列系列数据库将数据组织成行与列。 最简单形式的列系列数据库可能与关系数据库十分类似，至少在概念上是这样。 列系列数据库的真正强大之处在于，它能够以非规范化方式将稀疏数据结构化。 

可将列系列将数据库视为使用行与列保存表格数据，但是，列已分割为称作“列系列”的组。 每个列系列保存一组逻辑相关的、通常以单元形式检索或处理的列。 其他单独访问的数据可存储在单独的列系列中。 在列系列中，可以动态添加新列，行可以稀疏分布（即，行不需要包含每个列的值）。

下图显示了包含两个列系列（`Identity` 和 `Contact Info`）的示例。 在每个列系列中，单个实体的数据具有相同的行键。 此结构体现了列系列方法的重要优势，其中的列系列中任意给定对象的行可能动态变化，因此，这种形式的数据存储非常适合用于存储结构化的易失性数据。

![](./images/column-family.png) 

与键/值存储或文档数据库不同，大多数列系列数据库根据键顺序而不是通过计算哈希来存储数据。 许多实现允许基于列系列中的特定列创建索引。 使用索引可以根据列值而不是行键检索数据。

针对行执行的读取和写入操作通常是对单个列系列执行的原子操作，不过，某些实现可提供跨多个列系列的整行读写原子性。

相关的 Azure 服务：[HDInsight 中的 HBase][hbase]

## <a name="data-analytics"></a>数据分析

数据分析存储提供用于引入、存储和分析数据的大规模并行解决方案。 此数据是使用无共享体系结构跨多个服务器分布的，可最大程度地提高可伸缩性和降低依赖性。 数据不太可能是静态的，因此这些存储必须能够处理多个流以不同格式发来的大量信息，同时能够继续处理新查询。 

相关的 Azure 服务：

- [SQL 数据仓库][sql-dw]
- [Azure Data Lake][data-lake]

## <a name="search-engine-databases"></a>搜索引擎数据库  

搜索引擎数据库支持搜索外部数据存储和服务中保存的信息的功能。 可以使用搜索引擎数据库为大量数据编制索引，并以接近实时的速度访问这些索引。 尽管搜索引擎数据库广泛被认为与 Web 同义，但许多大型系统在其自身数据库的顶层使用搜索引擎数据库来提供结构化即席搜索功能。

搜索引擎数据库的主要特征是能够极快地存储信息和编制信息的索引，并针对搜索请求快速做出响应。 索引可以是多维的，且支持跨大量文本数据执行自由文本搜索。 可以使用由搜索引擎数据库触发的拉取模型或者使用由外部应用程序代码启动的推送模型来执行索引编制。 

搜索可以采用精确匹配或模糊匹配。 模糊搜索查找与一组字词匹配的文档，并计算它们的匹配程度。 某些搜索引擎还支持语言分析，此功能可根据同义词、类型扩展（例如，将 `dogs` 与 `pets` 匹配）和词干（将单词与同一个字根进行匹配）返回匹配结果。 

相关的 Azure 服务：[Azure 搜索][search]

## <a name="time-series-databases"></a>时序数据库

时序数据是按时间组织的一组值，时序数据库是已针对此类数据进行优化的数据库。 时序数据库必须支持极大量的写入，因为它们通常实时从大量源收集大量数据。 更新极少发生，而删除操作往往以批量操作的形式执行。 尽管写入时序数据库的记录通常较小，但记录数量往往很大，并且总数据大小可能迅速增长。

时序数据库适合用于存储遥测数据。 方案包括 IoT 传感器或应用程序/系统计数器。

相关的 Azure 服务：[时序见解][time-series]

## <a name="object-storage"></a>对象存储  

经优化的对象存储适合用于存储和检索大型二进制对象（图像、文件、视频和音频流、大型应用程序数据对象和文档、虚拟机磁盘映像）。 这些存储类型中的对象包括存储的数据、某些元数据，以及用于访问对象的唯一 ID。 使用对象存储可以管理极大量的非结构化数据。  

相关的 Azure 服务：[Blob 存储][blob]

## <a name="shared-files"></a>共享文件   

有时，使用简单的平面文件可能是存储和检索信息的最有效方法。 使用文件共享可以跨网络访问文件。 在提供了相应的安全和并发访问控制机制的前提下，以这种方法共享数据可让分布式服务提供高度可缩放的数据访问方式来执行基本的低级别操作，例如简单的读取和写入请求。

相关的 Azure 服务：[文件存储][file-storage]

<!-- links -->

[blob]: https://azure.microsoft.com/services/storage/blobs/
[cosmosdb]: https://azure.microsoft.com/services/cosmos-db/
[data-lake]: https://azure.microsoft.com/solutions/data-lake/
[file-storage]: https://azure.microsoft.com/services/storage/files/
[hbase]: /azure/hdinsight/hdinsight-hbase-overview
[mysql]: https://azure.microsoft.com/services/mysql/
[postgres]: https://azure.microsoft.com/services/postgresql/
[redis-cache]: https://azure.microsoft.com/services/cache/
[search]: https://azure.microsoft.com/services/search/
[sql-db]: https://azure.microsoft.com/services/sql-database
[sql-dw]: https://azure.microsoft.com/services/sql-data-warehouse/
[time-series]: https://azure.microsoft.com/services/time-series-insights/
