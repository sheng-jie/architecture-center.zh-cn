---
title: 使用工作的最佳数据存储
description: 选择最适合数据的存储技术，并了解如何使用该技术
author: MikeWasson
layout: LandingPage
ms.openlocfilehash: ef9439f7a3766d13b498eac915e0f5afd23de4e2
ms.sourcegitcommit: b0482d49aab0526be386837702e7724c61232c60
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 11/14/2017
---
# <a name="use-the-best-data-store-for-the-job"></a>使用工作的最佳数据存储

## <a name="pick-the-storage-technology-that-is-the-best-fit-for-your-data-and-how-it-will-be-used"></a>选择最适合数据的存储技术，并了解如何使用该技术

现在再也无需将所有数据粘贴到大型 SQL 关系数据库。 关系数据库非常擅长通过关系数据为事务提供 ACID 保证。 但这会产生一些费用：

- 查询可能需要高成本联接。
- 数据必须规范化，且符合预定义架构（写入架构）。
- 锁定争用可能会对性能产生影响。

在任何大型解决方案中，单个数据存储技术很可能满足不了所有需求。 关系数据库的替代方案包括键/值存储、文档数据库、搜索引擎数据库、时间序列数据库、列系列数据库和图形数据库。 每个方案都有其优缺点，不同类型的数据适合其中不同的方案。 

例如，可将产品目录存储在文档数据库（如 Cosmos DB）中，这可实现灵活架构。 在这种情况下，每个产品描述是一个自包含文档。 若要查询整个目录，可以索引目录并将索引存储在 Azure 搜索中。 产品清单可以存储在 SQL 数据库中，因为这类数据需要 ACID 保证。

请记住，数据不仅仅包括持久化的应用程序数据。 还包括应用程序日志、事件、消息和缓存。

## <a name="recommendations"></a>建议

请勿在任何情况下都使用关系数据库。 请考虑在适当的时候使用其他数据存储。 请参阅[选择正确的数据存储][data-store-overview]。

采用混合持久性。 在任何大型解决方案中，单个数据存储技术很可能满足不了所有需求。 

请考虑数据的类型。 例如，将事务数据存储在 SQL 中，将 JSON 文档存储在文档数据库中，将遥测数据存储在时间序列数据库中，将应用程序日志存储在 Elasticsearch 中，并将 Blob 存储在 Azure Blob 存储中。

优先考虑可用性而非（强）一致性。 CAP 定理意味着分布式系统须权衡可用性和一致性。 （网络分区，是 CAP 定理中不能完全避免的另一方面。）通常情况下，可以通过采用最终一致性模型来获得更高的可用性。 

请考虑开发团队的技能组合。 使用混合持久性有一些好处，但也有可能适得其反。 采用新的数据存储技术需要新的技能组合。 开发团队须了解如何充分利用此技术。 他们必须了解恰当的使用模式、如何优化查询、调整性能等。 请在考虑存储技术时将此因素考虑在内。 

使用补偿事务。 混合持久性的副作用是单个事务可能会将数据写入多个存储。 如果出现故障，使用补偿事务来撤消任何已完成的步骤。

查看界限上下文。 界限上下文是域驱动设计中的一个术语。 界限上下文是域模型的显式边界，它定义模型适用于域的哪个部分。 理想情况下，界限上下文将映射到业务域的子域。 系统中的界线上下文是考虑混合持久性的自然位置。 例如，“产品”可能会出现在产品目录子域和产品清单子域，但这两个子域很可能对存储、更新、查询产品的要求不同。

[data-store-overview]: ../technology-choices/data-store-overview.md